import{_ as f,o as c,c as u,g as o,t as S,p as w,i as b,f as v,r as p,e as h,k as $,d as g,w as m,F as _,a as C,T as O,b as A,l as D,m as k,j}from"./app-AHIMWW8m.js";import{T as Z,H,P as B}from"./preloader-BDqgj3Dm.js";const z={name:"GroupItemTitle",props:["itemData"],setup(){return{vueStore:window._vueStore}},methods:{editGroupNameOnClick(t){const e=this.vueStore.groupsMap.get(`${t}`),s=prompt("Новое имя группы",e.groupName);fetch("/group-rename",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({groupId:t,groupName:s})}).then(n=>n.json()).then(n=>{n.server_answer!="error"&&(e.groupName=s),console.debug(n)}).catch(n=>console.log("request failed",n))},addToGroupOnClick(t){console.debug(this.vueStore.groupsModalWindow),this.vueStore.groupsModalWindow.showGroupModal(`${t}`)},removeFromGroupOnClick(t){confirm("Удалить из группы")&&fetch("/group-remove-from-group",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({groupId:t})}).then(e=>e.json()).then(e=>{if(e.server_answer!="error"){const s=this.vueStore.groupsMap.get(`${t}`);s.parentGroupId="-1"}console.debug(e)}).catch(e=>console.log("request failed",e))},removeGroupOnClick(t){confirm("Удалить группу?")&&fetch("/group-remove",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({groupId:t})}).then(e=>e.json()).then(e=>{if(e.server_answer!="error"){const s=Array.from(this.vueStore.campaignsMap).filter(l=>l[1].parentId==t);for(const l of s)l[1].parentId="-1";const n=Array.from(this.vueStore.groupsMap).filter(l=>l[1].parentGroupId==t);for(const l of n)l[1].parentGroupId="-1";this.vueStore.groupsMap.delete(`${t}`)}console.debug(e)}).catch(e=>console.log("request failed",e))}}},M=t=>(w("data-v-b8b65d0e"),t=t(),b(),t),W={class:"group_title"},P=["title"],q=M(()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-pencil",viewBox:"0 0 16 16"},[o("path",{d:"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"})],-1)),J=[q],F=M(()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-database-add",viewBox:"0 0 16 16"},[o("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm.5-5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 1 0Z"}),o("path",{d:"M12.096 6.223A4.92 4.92 0 0 0 13 5.698V7c0 .289-.213.654-.753 1.007a4.493 4.493 0 0 1 1.753.25V4c0-1.007-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1s-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4v9c0 1.007.875 1.755 1.904 2.223C4.978 15.71 6.427 16 8 16c.536 0 1.058-.034 1.555-.097a4.525 4.525 0 0 1-.813-.927C8.5 14.992 8.252 15 8 15c-1.464 0-2.766-.27-3.682-.687C3.356 13.875 3 13.373 3 13v-1.302c.271.202.58.378.904.525C4.978 12.71 6.427 13 8 13h.027a4.552 4.552 0 0 1 0-1H8c-1.464 0-2.766-.27-3.682-.687C3.356 10.875 3 10.373 3 10V8.698c.271.202.58.378.904.525C4.978 9.71 6.427 10 8 10c.262 0 .52-.008.774-.024a4.525 4.525 0 0 1 1.102-1.132C9.298 8.944 8.666 9 8 9c-1.464 0-2.766-.27-3.682-.687C3.356 7.875 3 7.373 3 7V5.698c.271.202.58.378.904.525C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777ZM3 4c0-.374.356-.875 1.318-1.313C5.234 2.271 6.536 2 8 2s2.766.27 3.682.687C12.644 3.125 13 3.627 13 4c0 .374-.356.875-1.318 1.313C10.766 5.729 9.464 6 8 6s-2.766-.27-3.682-.687C3.356 4.875 3 4.373 3 4Z"})],-1)),U=[F],R=M(()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-database-dash",viewBox:"0 0 16 16"},[o("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7ZM11 12h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1Z"}),o("path",{d:"M12.096 6.223A4.92 4.92 0 0 0 13 5.698V7c0 .289-.213.654-.753 1.007a4.493 4.493 0 0 1 1.753.25V4c0-1.007-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1s-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4v9c0 1.007.875 1.755 1.904 2.223C4.978 15.71 6.427 16 8 16c.536 0 1.058-.034 1.555-.097a4.525 4.525 0 0 1-.813-.927C8.5 14.992 8.252 15 8 15c-1.464 0-2.766-.27-3.682-.687C3.356 13.875 3 13.373 3 13v-1.302c.271.202.58.378.904.525C4.978 12.71 6.427 13 8 13h.027a4.552 4.552 0 0 1 0-1H8c-1.464 0-2.766-.27-3.682-.687C3.356 10.875 3 10.373 3 10V8.698c.271.202.58.378.904.525C4.978 9.71 6.427 10 8 10c.262 0 .52-.008.774-.024a4.525 4.525 0 0 1 1.102-1.132C9.298 8.944 8.666 9 8 9c-1.464 0-2.766-.27-3.682-.687C3.356 7.875 3 7.373 3 7V5.698c.271.202.58.378.904.525C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777ZM3 4c0-.374.356-.875 1.318-1.313C5.234 2.271 6.536 2 8 2s2.766.27 3.682.687C12.644 3.125 13 3.627 13 4c0 .374-.356.875-1.318 1.313C10.766 5.729 9.464 6 8 6s-2.766-.27-3.682-.687C3.356 4.875 3 4.373 3 4Z"})],-1)),Y=[R],X=M(()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-trash3",viewBox:"0 0 16 16"},[o("path",{d:"M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"})],-1)),K=[X];function Q(t,e,s,n,l,r){return c(),u("div",W,[o("div",{class:"label",title:s.itemData.groupName},S(s.itemData.groupName),9,P),o("div",{class:"edit_group_name",title:"Изменить имя группы",onClick:e[0]||(e[0]=a=>r.editGroupNameOnClick(s.itemData.groupId))},J),s.itemData.parentGroupId=="-1"?(c(),u("div",{key:0,class:"add_group_button",title:"Добавить в группу",onClick:e[1]||(e[1]=a=>r.addToGroupOnClick(s.itemData.groupId))},U)):(c(),u("div",{key:1,class:"remove_from_group_button",title:"Удалить из группы",onClick:e[2]||(e[2]=a=>r.removeFromGroupOnClick(s.itemData.groupId))},Y)),o("div",{class:"delete_group_name",title:"Удалить группу",onClick:e[3]||(e[3]=a=>r.removeGroupOnClick(s.itemData.groupId))},K)])}const ee=f(z,[["render",Q],["__scopeId","data-v-b8b65d0e"]]),te={name:"GroupItem",components:{"group-item-title":ee},props:["itemData"],computed:{campaignsMapArray(){return Array.from(this.vueStore.campaignsMap).filter(t=>t[1].parentId==this.itemData.groupId)},groupsMapArray(){return Array.from(this.vueStore.groupsMap).filter(t=>t[1].parentGroupId==this.itemData.groupId).sort((t,e)=>t[1].groupOrder-e[1].groupOrder)}},setup(){const t=window._vueStore,e=v(!0),s=v(!0),n=v(!1),l=v(!1),r=v(!1);return{vueStore:t,itemsChildrenExpander:e,groupsChildrenExpander:s,borderedUp:n,borderedDown:l,dragged:r}},methods:{itemsChildrenExpanderOnClick(t){this.itemData.campaignsExtednded=!this.itemData.campaignsExtednded,console.debug(this.itemData.campaignsExtednded)},groupsChildrenExpanderOnClick(t){this.itemData.groupsExtended=!this.itemData.groupsExtended,console.debug(this.itemData.groupsExtended)},removeFromGroupOnClick(t){confirm("Удалить из группы?")&&fetch("/campaign-remove-from-group",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({campaignId:t})}).then(e=>e.json()).then(e=>{if(e.server_answer!="error"){const s=this.vueStore.campaignsMap.get(`${t}`);s.parentId="-1"}console.debug(e)}).catch(e=>console.log("request failed",e))},onGroupDragStart(t,e){this.vueStore.draggedElement=e,t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move",this.dragged=!0},onGroupDragEnd(t,e){if(this.borderedUp=!1,this.borderedDown=!1,this.dragged=!1,this.vueStore.overedElement==null||this.vueStore.draggedElement==null)return;console.debug("drag end",this.vueStore.draggedElement.itemData,this.vueStore.overedElement.itemData,this.vueStore.dragElementHalf),this.vueStore.draggedElement.itemData.groupOrder=this.vueStore.dragElementHalf?this.vueStore.overedElement.itemData.groupOrder-.5:this.vueStore.overedElement.itemData.groupOrder+.5;const s=this.vueStore.overedElement.itemData.parentGroupId,n=Array.from(this.vueStore.groupsMap).filter(a=>a[1].parentGroupId==s).sort((a,i)=>a[1].groupOrder-i[1].groupOrder);let l=0;const r={};for(const[a,i]of n)r[`${i.groupId}`]=l,i.groupOrder=l++;console.debug(r),fetch("/group-set-order",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({ordersList:r})}).then(a=>a.json()).then(a=>console.debug(a)).catch(a=>console.log("request failed",a)),this.vueStore.dragElementHalf=null,this.vueStore.overedElement=null,this.vueStore.draggedElement==null},onGroupDragOver(t,e){if(e==this.vueStore.draggedElement||e.itemData.groupLevel!=this.vueStore.draggedElement.itemData.groupLevel||e.itemData.parentGroupId!=this.vueStore.draggedElement.itemData.parentGroupId)return;function s(l){let r=l.getBoundingClientRect(),a=document.body,i=document.documentElement,d=window.pageYOffset||i.scrollTop||a.scrollTop,I=window.pageXOffset||i.scrollLeft||a.scrollLeft,y=i.clientTop||a.clientTop||0,N=i.clientLeft||a.clientLeft||0,L=r.top+d-y,V=r.left+I-N;return{top:L,left:V}}const n=t.clientY-s(this.$refs.item).top<=this.$refs.item.getBoundingClientRect().height*.5;this.borderedUp=!!n,this.borderedDown=!n,t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move",this.vueStore.overedElement=e,this.vueStore.dragElementHalf=n},onGroupDragLeave(){this.borderedUp=!1,this.borderedDown=!1}}},G=t=>(w("data-v-977e6445"),t=t(),b(),t),oe=["group_id"],re={class:"group_childs"},se={key:0,class:"items_children"},ae=G(()=>o("div",{class:"title"},"Кампании",-1)),ne=G(()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-caret-right",viewBox:"0 0 16 16"},[o("path",{d:"M6 12.796V3.204L11.481 8 6 12.796zm.659.753 5.48-4.796a1 1 0 0 0 0-1.506L6.66 2.451C6.011 1.885 5 2.345 5 3.204v9.592a1 1 0 0 0 1.659.753z"})],-1)),de=[ne],ie={key:0,class:"items_children_list"},ce={class:"campaign_name"},le={class:"campaign_label"},ue={class:"campaign_icons"},pe=["onClick"],he=G(()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-database-dash",viewBox:"0 0 16 16"},[o("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7ZM11 12h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1Z"}),o("path",{d:"M12.096 6.223A4.92 4.92 0 0 0 13 5.698V7c0 .289-.213.654-.753 1.007a4.493 4.493 0 0 1 1.753.25V4c0-1.007-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1s-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4v9c0 1.007.875 1.755 1.904 2.223C4.978 15.71 6.427 16 8 16c.536 0 1.058-.034 1.555-.097a4.525 4.525 0 0 1-.813-.927C8.5 14.992 8.252 15 8 15c-1.464 0-2.766-.27-3.682-.687C3.356 13.875 3 13.373 3 13v-1.302c.271.202.58.378.904.525C4.978 12.71 6.427 13 8 13h.027a4.552 4.552 0 0 1 0-1H8c-1.464 0-2.766-.27-3.682-.687C3.356 10.875 3 10.373 3 10V8.698c.271.202.58.378.904.525C4.978 9.71 6.427 10 8 10c.262 0 .52-.008.774-.024a4.525 4.525 0 0 1 1.102-1.132C9.298 8.944 8.666 9 8 9c-1.464 0-2.766-.27-3.682-.687C3.356 7.875 3 7.373 3 7V5.698c.271.202.58.378.904.525C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777ZM3 4c0-.374.356-.875 1.318-1.313C5.234 2.271 6.536 2 8 2s2.766.27 3.682.687C12.644 3.125 13 3.627 13 4c0 .374-.356.875-1.318 1.313C10.766 5.729 9.464 6 8 6s-2.766-.27-3.682-.687C3.356 4.875 3 4.373 3 4Z"})],-1)),ge=[he],me={key:1,class:"groups_children"},_e=G(()=>o("div",{class:"title"},"Подгруппы",-1)),ve=G(()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-caret-right",viewBox:"0 0 16 16"},[o("path",{d:"M6 12.796V3.204L11.481 8 6 12.796zm.659.753 5.48-4.796a1 1 0 0 0 0-1.506L6.66 2.451C6.011 1.885 5 2.345 5 3.204v9.592a1 1 0 0 0 1.659.753z"})],-1)),fe=[ve],Ce={key:0,class:"groups_children_list"};function we(t,e,s,n,l,r){const a=p("group-item-title"),i=p("GroupItem",!0);return c(),u("div",{class:$(["group_item",[n.borderedUp?"borderedUp":!1,n.borderedDown?"borderedDown":!1,n.dragged?"dragged":!1]]),group_id:s.itemData.groupId,draggable:"true",ref:"item",onDragstart:e[2]||(e[2]=D(d=>r.onGroupDragStart(d,this),["stop"])),onDragover:e[3]||(e[3]=D(d=>r.onGroupDragOver(d,this),["stop"])),onDragend:e[4]||(e[4]=D(d=>r.onGroupDragEnd(d,this),["stop"])),onDragleave:e[5]||(e[5]=d=>r.onGroupDragLeave())},[h(a,{itemData:s.itemData},null,8,["itemData"]),o("div",re,[r.campaignsMapArray.length>0?(c(),u("div",se,[ae,o("div",{class:$(["expander",{expanded:s.itemData.campaignsExtednded}]),onClick:e[0]||(e[0]=(...d)=>r.itemsChildrenExpanderOnClick&&r.itemsChildrenExpanderOnClick(...d))},de,2)])):g("",!0),h(O,{name:"scaler"},{default:m(()=>[s.itemData.campaignsExtednded==!0&&r.campaignsMapArray.length>0?(c(),u("div",ie,[(c(!0),u(_,null,C(r.campaignsMapArray,d=>(c(),u("div",ce,[o("div",le,S(d[1].CampaignName),1),o("div",ue,[o("div",{class:"remove_from_group",title:"Удалить из группы",onClick:I=>r.removeFromGroupOnClick(d[1].CampaignId)},ge,8,pe)])]))),256))])):g("",!0)]),_:1}),r.groupsMapArray.length>0?(c(),u("div",me,[_e,o("div",{class:$(["expander",{expanded:s.itemData.groupsExtended}]),onClick:e[1]||(e[1]=(...d)=>r.groupsChildrenExpanderOnClick&&r.groupsChildrenExpanderOnClick(...d))},fe,2)])):g("",!0),h(O,{name:"scaler"},{default:m(()=>[s.itemData.groupsExtended==!0&&r.groupsMapArray.length>0?(c(),u("div",Ce,[(c(!0),u(_,null,C(r.groupsMapArray,d=>(c(),A(i,{itemData:d[1]},null,8,["itemData"]))),256))])):g("",!0)]),_:1})])],42,oe)}const be=f(te,[["render",we],["__scopeId","data-v-977e6445"]]),Ie={name:"ModalWindow",data:function(){return{show:!1}},setup(){return{vueStore:window._vueStore}},methods:{showModal:function(){this.show=!0},closeModal:function(){this.show=!1}}},Se=t=>(w("data-v-b2109bb8"),t=t(),b(),t),Ge={key:0,class:"modal-shadow"},Me={class:"modal"},ye={class:"modal_header"},$e=Se(()=>o("h3",{class:"modal-title"},"Заголовок",-1)),De={class:"modal_content"},ke={class:"modal_footer"};function Ae(t,e,s,n,l,r){return t.show?(c(),u("div",Ge,[o("div",Me,[o("div",ye,[k(t.$slots,"title",{},()=>[$e],!0),o("div",{class:"modal-close",onClick:e[0]||(e[0]=(...a)=>r.closeModal&&r.closeModal(...a))},"✖")]),o("div",De,[k(t.$slots,"body",{},()=>[j(" body ")],!0)]),o("div",ke,[k(t.$slots,"footer",{},()=>[o("button",{class:"modal-footer__button",onClick:e[1]||(e[1]=(...a)=>r.closeModal&&r.closeModal(...a))}," Ок ")],!0)])])])):g("",!0)}const E=f(Ie,[["render",Ae],["__scopeId","data-v-b2109bb8"]]),xe={name:"GroupsList",components:{"group-item":be,"modal-window":E},computed:{groupsMapArray(){const t=Array.from(this.vueStore.groupsMap).filter(e=>e[1].parentGroupId=="-1").sort((e,s)=>e[1].groupOrder-s[1].groupOrder);return console.debug(t),t},filteredHierarchyGroupArray(){const t=[],e=this.vueStore.groupsMap,s=e.get(`${this.subGroupId}`);function n(l){t.push(l.groupId);const r=Array.from(e).filter(a=>a[1].parentGroupId==l.groupId);for(const a of r){const i=e.get(`${a[1].groupId}`);n(i)}}return n(s),Array.from(this.vueStore.groupsMap).filter(l=>!t.includes(l[1].groupId))}},setup(){const t=window._vueStore,e=-1,s=v(-1);return{vueStore:t,currentGroupId:e,subGroupId:s}},mounted(){this.vueStore.groupsModalWindow=this},methods:{toggleGroup(t){const e=this.vueStore.groupsMap.get(`${t}`);if(e)if(e.chosen)e.chosen=!1,this.currentGroupId=-1;else{for(const s of Array.from(this.vueStore.groupsMap))s[1].chosen=!1;e.chosen=!0,this.currentGroupId=e.groupId}},buttonAddClick(){console.debug(this.currentGroupId,this.subGroupId),this.$refs.modalWindow.show=!1,this.currentGroupId!=-1&&this.subGroupId!=-1&&fetch("/group-add-to-group",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({groupId:this.subGroupId,parentGroupId:this.currentGroupId})}).then(t=>t.json()).then(t=>{if(t.server_answer!="error"){const e=this.vueStore.groupsMap.get(`${this.subGroupId}`);e.parentGroupId=this.currentGroupId}console.debug(t)}).catch(t=>console.log("request failed",t))},showGroupModal(t){for(const e of Array.from(this.vueStore.groupsMap))e[1].chosen=!1;this.$refs.modalWindow.show=!0,this.subGroupId=t,console.debug(t)},addNewGroup(){const t=prompt("Введите имя новой группы","");fetch("/group-add",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({groupName:t})}).then(e=>e.json()).then(e=>{e.server_answer!="error"&&this.vueStore.groupsMap.set(`${e.group_id}`,{groupId:`${e.group_id}`,groupName:`${e.groupName}`,parentGroupId:"-1",chosen:!1,campaignsExtednded:!0,groupsExtended:!0}),console.debug(e)}).catch(e=>console.log("request failed",e))}}},x=t=>(w("data-v-27c9b9a8"),t=t(),b(),t),Oe=x(()=>o("h3",{class:"modal-title"},"Добавить группу в другую группу",-1)),Ee=["onClick"],Te={class:"group_label"},Ne={key:0,class:"group_marker"},Le=x(()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-check-lg",viewBox:"0 0 16 16"},[o("path",{d:"M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425a.247.247 0 0 1 .02-.022Z"})],-1)),Ve=[Le],je={class:"list_header"},Ze=x(()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-plus-circle",viewBox:"0 0 16 16"},[o("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"}),o("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)),He=[Ze],Be={class:"list_body"};function ze(t,e,s,n,l,r){const a=p("modal-window"),i=p("group-item");return c(),u(_,null,[h(a,{ref:"modalWindow"},{title:m(()=>[Oe]),body:m(()=>[(c(!0),u(_,null,C(r.filteredHierarchyGroupArray,d=>(c(),u("div",{class:"group_name",onClick:I=>r.toggleGroup(d[1].groupId)},[o("div",Te,S(d[1].groupName),1),d[1].chosen?(c(),u("div",Ne,Ve)):g("",!0)],8,Ee))),256))]),footer:m(()=>[o("button",{onClick:e[0]||(e[0]=(...d)=>r.buttonAddClick&&r.buttonAddClick(...d))},"Добавить")]),_:1},512),o("div",je,[o("div",{class:"add_new_group",title:"Создать новую группу",onClick:e[1]||(e[1]=(...d)=>r.addNewGroup&&r.addNewGroup(...d))},He)]),o("div",Be,[(c(!0),u(_,null,C(r.groupsMapArray,d=>(c(),A(i,{itemData:d[1]},null,8,["itemData"]))),256))])],64)}const We=f(xe,[["render",ze],["__scopeId","data-v-27c9b9a8"]]),Pe={name:"ModalGroupDialog",components:{"modal-window":E},setup(){return{vueStore:window._vueStore,currentGroupId:-1,currentCampaignId:-1}},methods:{showModal:function(t=-1){this.currentCampaignId=t,this.$refs.modalWindow.showModal(),this.currentGroupId=-1;for(const e of Array.from(this.vueStore.groupsMap))e[1].chosen=!1},closeModal:function(){this.$refs.modalWindow.closeModal()},toggleGroup(t){const e=this.vueStore.groupsMap.get(`${t}`);if(e)if(e.chosen)e.chosen=!1,this.currentGroupId=-1;else{for(const s of Array.from(this.vueStore.groupsMap))s[1].chosen=!1;e.chosen=!0,this.currentGroupId=e.groupId}},buttonAddClick(){console.debug(this.currentGroupId,this.currentCampaignId),this.closeModal(),this.currentGroupId!=-1&&this.currentCampaignId!=-1&&fetch("/campaign-add-to-group",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({groupId:this.currentGroupId,campaignId:this.currentCampaignId})}).then(t=>t.json()).then(t=>{if(t.server_answer!="error"){const e=this.vueStore.campaignsMap.get(`${this.currentCampaignId}`);e.parentId=this.currentGroupId}console.debug(t)}).catch(t=>console.log("request failed",t))}}},T=t=>(w("data-v-1347f4c7"),t=t(),b(),t),qe=T(()=>o("h3",{class:"modal-title"},"Добавить кампанию в группу",-1)),Je=["onClick"],Fe={class:"group_label"},Ue={key:0,class:"group_marker"},Re=T(()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-check-lg",viewBox:"0 0 16 16"},[o("path",{d:"M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425a.247.247 0 0 1 .02-.022Z"})],-1)),Ye=[Re];function Xe(t,e,s,n,l,r){const a=p("modal-window");return c(),A(a,{ref:"modalWindow"},{title:m(()=>[qe]),body:m(()=>[(c(!0),u(_,null,C(Array.from(n.vueStore.groupsMap),i=>(c(),u("div",{class:"group_name",onClick:d=>r.toggleGroup(i[1].groupId)},[o("div",Fe,S(i[1].groupName),1),i[1].chosen?(c(),u("div",Ue,Ye)):g("",!0)],8,Je))),256))]),footer:m(()=>[o("button",{onClick:e[0]||(e[0]=(...i)=>r.buttonAddClick&&r.buttonAddClick(...i))},"Добавить")]),_:1},512)}const Ke=f(Pe,[["render",Xe],["__scopeId","data-v-1347f4c7"]]),Qe={name:"CampaignList",components:{"modal-group-dialog":Ke},setup(){return{vueStore:window._vueStore}},methods:{showModalAddToGroup(t){this.$refs.modalGroupDialog.showModal(t)}}},et=t=>(w("data-v-fda119b4"),t=t(),b(),t),tt={class:"compaign_item"},ot=["title"],rt=["onClick"],st=et(()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-database-add",viewBox:"0 0 16 16"},[o("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm.5-5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 1 0Z"}),o("path",{d:"M12.096 6.223A4.92 4.92 0 0 0 13 5.698V7c0 .289-.213.654-.753 1.007a4.493 4.493 0 0 1 1.753.25V4c0-1.007-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1s-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4v9c0 1.007.875 1.755 1.904 2.223C4.978 15.71 6.427 16 8 16c.536 0 1.058-.034 1.555-.097a4.525 4.525 0 0 1-.813-.927C8.5 14.992 8.252 15 8 15c-1.464 0-2.766-.27-3.682-.687C3.356 13.875 3 13.373 3 13v-1.302c.271.202.58.378.904.525C4.978 12.71 6.427 13 8 13h.027a4.552 4.552 0 0 1 0-1H8c-1.464 0-2.766-.27-3.682-.687C3.356 10.875 3 10.373 3 10V8.698c.271.202.58.378.904.525C4.978 9.71 6.427 10 8 10c.262 0 .52-.008.774-.024a4.525 4.525 0 0 1 1.102-1.132C9.298 8.944 8.666 9 8 9c-1.464 0-2.766-.27-3.682-.687C3.356 7.875 3 7.373 3 7V5.698c.271.202.58.378.904.525C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777ZM3 4c0-.374.356-.875 1.318-1.313C5.234 2.271 6.536 2 8 2s2.766.27 3.682.687C12.644 3.125 13 3.627 13 4c0 .374-.356.875-1.318 1.313C10.766 5.729 9.464 6 8 6s-2.766-.27-3.682-.687C3.356 4.875 3 4.373 3 4Z"})],-1)),at=[st];function nt(t,e,s,n,l,r){const a=p("modal-group-dialog");return c(),u(_,null,[h(a,{ref:"modalGroupDialog"},null,512),(c(!0),u(_,null,C(Array.from(n.vueStore.campaignsMap).filter(i=>i[1].parentId==-1),i=>(c(),u("div",null,[o("div",tt,[o("div",{class:"label",title:i[1].CampaignName},S(i[1].CampaignName),9,ot),o("div",{class:"add_group_button",title:"Добавить в группу",onClick:d=>r.showModalAddToGroup(i[1].CampaignId)},at,8,rt)])]))),256))],64)}const dt=f(Qe,[["render",nt],["__scopeId","data-v-fda119b4"]]),it={name:"outsidersView",components:{"groups-list":We,"campaign-list":dt,"table-list-header":Z,"header-tabs":H,preloader:B},setup(){const t=v(0),e=window._vueStore;return{activeTab:t,vueStore:e}}},ct={class:"work_area"},lt={class:"tabs_area"},ut={class:"tabs_area_header_wrapper"},pt={class:"tabs_area_header"},ht={class:"tabs_area_body_wrapper"},gt={class:"tabs_area_body"},mt={key:0,class:"tab_panel constructor active"},_t={class:"tab_panel_left"},vt={class:"tab_panel_right"};function ft(t,e,s,n,l,r){const a=p("table-list-header"),i=p("header-tabs"),d=p("preloader"),I=p("groups-list"),y=p("campaign-list");return c(),u("div",ct,[o("div",lt,[o("div",ut,[o("div",pt,[h(a),h(i)])]),h(d),o("div",ht,[o("div",gt,[n.vueStore.loading==!1?(c(),u("div",mt,[o("div",_t,[h(I)]),o("div",vt,[h(y)])])):g("",!0)])])])])}const bt=f(it,[["render",ft],["__scopeId","data-v-fd921697"]]);export{bt as default};
