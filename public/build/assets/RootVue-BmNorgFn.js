import{S as W,H as J}from"./SubGroupsTable-mt8dUVJU.js";import{_ as v,r as h,o as l,c as i,F as g,a as m,b as k,d as p,e as b,f as s,t as u,n as f,p as C,g as w,h as P,i as S,j as $,w as y,T as L,k as N,l as V,m as H}from"./app-BaVlKkDk.js";const U={name:"HubSubTable",components:{"sub-groups-table":W},computed:{hubGroups(){return Array.from(this.vueStore.groupsMap).filter(t=>t[1].parentGroupId=="-1").sort((t,d)=>t[1].groupOrder-d[1].groupOrder)}},setup(){return{vueStore:window._vueStore}}},Y={key:0,class:"table"};function X(e,t,d,r,c,o){const n=h("sub-groups-table");return r.vueStore.loading==!1?(l(),i("div",Y,[(l(!0),i(g,null,m(o.hubGroups,([a,_])=>(l(),k(n,{groupId:_.groupId},null,8,["groupId"]))),256))])):p("",!0)}const K=v(U,[["render",X],["__scopeId","data-v-98f0153c"]]),Q={name:"TableList",components:{"hub-table":J,"hub-sub-table":K}},ee={class:"table_list_body"};function te(e,t,d,r,c,o){const n=h("hub-table"),a=h("hub-sub-table");return l(),i("div",ee,[b(n),b(a)])}const se=v(Q,[["render",te],["__scopeId","data-v-85bce701"]]),oe={name:"HubTable",computed:{hubGroups(){return Array.from(this.vueStore.groupsMap).filter(t=>t[1].parentGroupId=="-1").sort((t,d)=>t[1].groupOrder-d[1].groupOrder)},allClicks(){return String(this.vueStore.allClicksValue).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")},allCoasts(){return String(this.vueStore.allCostValue.toFixed(0)).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" ₽"},allImpressions(){return String(this.vueStore.allImpressionsValue).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")}},setup(){return{vueStore:window._vueStore}}},ae=e=>(C("data-v-4827dc81"),e=e(),w(),e),re={key:0,class:"table"},le={class:"table_row"},ie={class:"table_row_item"},de={class:"table_row_item"},ce={class:"front_cell"},ne={key:0,class:"table_row_item_bubble_wrapper"},ue={class:"table_row_item_bubble"},_e={class:"table_row_item"},pe={class:"front_cell"},he={class:"table_footer"},ge=ae(()=>s("div",{class:"table_footer_item"},"Итого",-1)),ve={class:"table_footer_item"},be={key:0,class:"table_row_item_bubble_wrapper"},me={class:"table_row_item_bubble"},fe={class:"table_footer_item"};function Ce(e,t,d,r,c,o){return r.vueStore.loading==!1?(l(),i("div",re,[(l(!0),i(g,null,m(o.hubGroups,([n,a])=>(l(),i("div",le,[s("div",ie,u(a.groupName),1),s("div",de,[s("div",{class:"back_cell",style:f({width:a.CostPerc+"%"})},null,4),s("div",ce,u(a.CostStr),1)]),a.Cost/a.Clicks?(l(),i("div",ne,[s("div",ue,u(String((a.Cost/a.Clicks).toFixed(1)).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" ₽"),1)])):p("",!0),s("div",_e,[s("div",{class:"back_cell",style:f({width:a.ClicksPerc+"%"})},null,4),s("div",pe,u(a.ClicksStr),1)])]))),256)),s("div",he,[ge,s("div",ve,u(o.allCoasts),1),r.vueStore.allCostValue/r.vueStore.allClicksValue?(l(),i("div",be,[s("div",me,u(String((r.vueStore.allCostValue/r.vueStore.allClicksValue).toFixed(1)).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" ₽"),1)])):p("",!0),s("div",fe,u(o.allClicks),1)])])):p("",!0)}const we=v(oe,[["render",Ce],["__scopeId","data-v-4827dc81"]]),$e={name:"SubGroupsItem",props:["groupId"],computed:{group(){return this.vueStore.groupsMap.get(`${this.groupId}`)},groupCPC(){const e=this.vueStore.groupsMap.get(`${this.groupId}`),t=e.Cost/e.Clicks;return t?String(t.toFixed(1)).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" ₽":""},campaigns(){return Array.from(this.vueStore.campaignsMap).filter(t=>t[1].parentId==this.groupId)}},setup(){return{vueStore:window._vueStore}},methods:{onExpanderClick(e){const t=this.vueStore.groupsMap.get(`${e}`);t.tableGroupsExtended=!t.tableGroupsExtended}}},T=e=>(C("data-v-f67d19b9"),e=e(),w(),e),Se={class:"table_row"},Ie={class:"table_row_item"},ye={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-plus-square",viewBox:"0 0 16 16"},ke=T(()=>s("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"},null,-1)),Ge=T(()=>s("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"},null,-1)),xe=[ke,Ge],Te={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-dash-square",viewBox:"0 0 16 16"},Me=T(()=>s("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"},null,-1)),Ae=T(()=>s("path",{d:"M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8z"},null,-1)),Ee=[Me,Ae],De={class:"name_label"},Oe={class:"table_row_item"},Ne={class:"front_cell"},Ve={key:0,class:"table_row_item_bubble_wrapper"},Pe={class:"table_row_item_bubble"},Re={class:"table_row_item"},Le={class:"front_cell"},He={class:"table_row campaigns"},je={class:"table_row_item"},ze=T(()=>s("div",{class:"campaign_shift"},null,-1)),Fe={class:"table_row_item"},Be={class:"front_cell"},Ze={key:0,class:"table_row_item_bubble_wrapper"},qe={class:"table_row_item_bubble"},We={class:"table_row_item"},Je={class:"front_cell"};function Ue(e,t,d,r,c,o){return l(),i(g,null,[s("div",Se,[s("div",Ie,[o.campaigns.length>0?(l(),i("div",{key:0,class:"group_expander",onClick:t[0]||(t[0]=n=>o.onExpanderClick(o.group.groupId))},[o.group.tableGroupsExtended==!1?(l(),i("svg",ye,xe)):p("",!0),o.group.tableGroupsExtended==!0?(l(),i("svg",Te,Ee)):p("",!0)])):p("",!0),s("div",De,u(o.group.groupName),1)]),s("div",Oe,[s("div",{class:"back_cell",style:f({width:o.group.CostPerc+"%"})},null,4),s("div",Ne,u(o.group.CostStr),1)]),o.groupCPC!=""?(l(),i("div",Ve,[s("div",Pe,u(o.groupCPC),1)])):p("",!0),s("div",Re,[s("div",{class:"back_cell",style:f({width:o.group.ClicksPerc+"%"})},null,4),s("div",Le,u(o.group.ClicksStr),1)])]),o.group.tableGroupsExtended?(l(!0),i(g,{key:0},m(o.campaigns,([n,a])=>(l(),i("div",He,[s("div",je,[ze,P(" "+u(a.CampaignName),1)]),s("div",Fe,[s("div",{class:"back_cell",style:f({width:a.CostPerc+"%"})},null,4),s("div",Be,u(a.CostStr),1)]),a.Cost/a.Clicks?(l(),i("div",Ze,[s("div",qe,u(String((a.Cost/a.Clicks).toFixed(1)).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" ₽"),1)])):p("",!0),s("div",We,[s("div",{class:"back_cell",style:f({width:a.ClicksPerc+"%"})},null,4),s("div",Je,u(a.ClicksStr),1)])]))),256)):p("",!0)],64)}const Ye=v($e,[["render",Ue],["__scopeId","data-v-f67d19b9"]]),Xe={name:"SubGroupsTable",props:["groupId"],components:{"sub-groups-item":Ye},computed:{group(){return this.vueStore.groupsMap.get(`${this.groupId}`)},subGroups(){return Array.from(this.vueStore.groupsMap).filter(t=>t[1].parentGroupId==this.groupId).sort((t,d)=>t[1].groupOrder-d[1].groupOrder)}},setup(){return{vueStore:window._vueStore}},methods:{}},j=e=>(C("data-v-d6a49141"),e=e(),w(),e),Ke={class:"hubs_groups"},Qe={class:"table_header"},et={class:"table_header_item"},tt=j(()=>s("div",{class:"table_header_item"},null,-1)),st=j(()=>s("div",{class:"table_header_item"},null,-1));function ot(e,t,d,r,c,o){const n=h("sub-groups-item");return l(),i("div",Ke,[s("div",Qe,[s("div",et,u(o.group.groupName),1),tt,st]),(l(!0),i(g,null,m(o.subGroups,([a,_])=>(l(),k(n,{groupId:_.groupId},null,8,["groupId"]))),256))])}const at=v(Xe,[["render",ot],["__scopeId","data-v-d6a49141"]]),rt={name:"HubSubTable",components:{"sub-groups-table":at},computed:{hubGroups(){return Array.from(this.vueStore.groupsMap).filter(t=>t[1].parentGroupId=="-1").sort((t,d)=>t[1].groupOrder-d[1].groupOrder)}},setup(){return{vueStore:window._vueStore}}},lt={key:0,class:"table"};function it(e,t,d,r,c,o){const n=h("sub-groups-table");return r.vueStore.loading==!1?(l(),i("div",lt,[(l(!0),i(g,null,m(o.hubGroups,([a,_])=>(l(),k(n,{groupId:_.groupId},null,8,["groupId"]))),256))])):p("",!0)}const dt=v(rt,[["render",it],["__scopeId","data-v-e6e17077"]]),ct={name:"TableListCPC",components:{"hub-table":we,"hub-sub-table":dt},computed:{allClicks(){return String(this.vueStore.allClicksValue).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")},allCoasts(){return String(this.vueStore.allCostValue.toFixed(0)).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" ₽"},allImpressions(){return String(this.vueStore.allImpressionsValue).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")}},setup(){const e=window._vueStore,t=S(!1);return{vueStore:e,allExpander:t}},methods:{onAllExpanderClick(){this.allExpander=!this.allExpander}}},nt={class:"table_list_body"};function ut(e,t,d,r,c,o){const n=h("hub-table"),a=h("hub-sub-table");return l(),i("div",nt,[b(n),b(a)])}const _t=v(ct,[["render",ut],["__scopeId","data-v-db3504e0"]]),pt={name:"HubTable",computed:{hubGroups(){return Array.from(this.vueStore.groupsMap).filter(t=>t[1].parentGroupId=="-1").sort((t,d)=>t[1].groupOrder-d[1].groupOrder)},allClicks(){return String(this.vueStore.allClicksValue).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")},allCoasts(){return String(this.vueStore.allCostValue.toFixed(0)).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" ₽"},allImpressions(){return String(this.vueStore.allImpressionsValue).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")}},setup(){return{vueStore:window._vueStore}}},ht=e=>(C("data-v-b3e43f14"),e=e(),w(),e),gt={key:0,class:"table"},vt={class:"table_row"},bt={class:"table_row_item"},mt={class:"table_row_item"},ft={class:"front_cell"},Ct={key:0,class:"table_row_item_bubble_wrapper"},wt={class:"table_row_item_bubble"},$t={class:"table_row_item"},St={class:"front_cell"},It={class:"table_footer"},yt=ht(()=>s("div",{class:"table_footer_item"},"Итого",-1)),kt={class:"table_footer_item"},Gt={key:0,class:"table_row_item_bubble_wrapper"},xt={class:"table_row_item_bubble"},Tt={class:"table_footer_item"};function Mt(e,t,d,r,c,o){return r.vueStore.loading==!1?(l(),i("div",gt,[(l(!0),i(g,null,m(o.hubGroups,([n,a])=>(l(),i("div",vt,[s("div",bt,u(a.groupName),1),s("div",mt,[s("div",{class:"back_cell",style:f({width:a.ImpressionsPerc+"%"})},null,4),s("div",ft,u(a.ImpressionsStr),1)]),100*a.Clicks/a.Impressions?(l(),i("div",Ct,[s("div",wt,u(String((100*a.Clicks/a.Impressions).toFixed(3)).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" %"),1)])):p("",!0),s("div",$t,[s("div",{class:"back_cell",style:f({width:a.ClicksPerc+"%"})},null,4),s("div",St,u(a.ClicksStr),1)])]))),256)),s("div",It,[yt,s("div",kt,u(o.allImpressions),1),100*r.vueStore.allClicksValue/r.vueStore.allImpressionsValue?(l(),i("div",Gt,[s("div",xt,u(String((100*r.vueStore.allClicksValue/r.vueStore.allImpressionsValue).toFixed(3)).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" %"),1)])):p("",!0),s("div",Tt,u(o.allClicks),1)])])):p("",!0)}const At=v(pt,[["render",Mt],["__scopeId","data-v-b3e43f14"]]),Et={name:"SubGroupsItem",props:["groupId"],computed:{group(){return this.vueStore.groupsMap.get(`${this.groupId}`)},groupCTR(){const e=this.vueStore.groupsMap.get(`${this.groupId}`),t=100*e.Clicks/e.Impressions;return t?String(t.toFixed(3)).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" %":""},campaigns(){return Array.from(this.vueStore.campaignsMap).filter(t=>t[1].parentId==this.groupId)}},setup(){return{vueStore:window._vueStore}},methods:{onExpanderClick(e){const t=this.vueStore.groupsMap.get(`${e}`);t.tableGroupsExtended=!t.tableGroupsExtended}}},M=e=>(C("data-v-b34e97bc"),e=e(),w(),e),Dt={class:"table_row"},Ot={class:"table_row_item"},Nt={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-plus-square",viewBox:"0 0 16 16"},Vt=M(()=>s("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"},null,-1)),Pt=M(()=>s("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"},null,-1)),Rt=[Vt,Pt],Lt={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-dash-square",viewBox:"0 0 16 16"},Ht=M(()=>s("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"},null,-1)),jt=M(()=>s("path",{d:"M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8z"},null,-1)),zt=[Ht,jt],Ft={class:"name_label"},Bt={class:"table_row_item"},Zt={class:"front_cell"},qt={key:0,class:"table_row_item_bubble_wrapper"},Wt={class:"table_row_item_bubble"},Jt={class:"table_row_item"},Ut={class:"front_cell"},Yt={class:"table_row campaigns"},Xt={class:"table_row_item"},Kt=M(()=>s("div",{class:"campaign_shift"},null,-1)),Qt={class:"table_row_item"},es={class:"front_cell"},ts={key:0,class:"table_row_item_bubble_wrapper"},ss={class:"table_row_item_bubble"},os={class:"table_row_item"},as={class:"front_cell"};function rs(e,t,d,r,c,o){return l(),i(g,null,[s("div",Dt,[s("div",Ot,[o.campaigns.length>0?(l(),i("div",{key:0,class:"group_expander",onClick:t[0]||(t[0]=n=>o.onExpanderClick(o.group.groupId))},[o.group.tableGroupsExtended==!1?(l(),i("svg",Nt,Rt)):p("",!0),o.group.tableGroupsExtended==!0?(l(),i("svg",Lt,zt)):p("",!0)])):p("",!0),s("div",Ft,u(o.group.groupName),1)]),s("div",Bt,[s("div",{class:"back_cell",style:f({width:o.group.ImpressionsPerc+"%"})},null,4),s("div",Zt,u(o.group.ImpressionsStr),1)]),o.groupCTR!=""?(l(),i("div",qt,[s("div",Wt,u(o.groupCTR),1)])):p("",!0),s("div",Jt,[s("div",{class:"back_cell",style:f({width:o.group.ClicksPerc+"%"})},null,4),s("div",Ut,u(o.group.ClicksStr),1)])]),o.group.tableGroupsExtended?(l(!0),i(g,{key:0},m(o.campaigns,([n,a])=>(l(),i("div",Yt,[s("div",Xt,[Kt,P(" "+u(a.CampaignName),1)]),s("div",Qt,[s("div",{class:"back_cell",style:f({width:a.ImpressionsPerc+"%"})},null,4),s("div",es,u(a.ImpressionsStr),1)]),100*a.Clicks/a.Impressions?(l(),i("div",ts,[s("div",ss,u(String((100*a.Clicks/a.Impressions).toFixed(3)).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" %"),1)])):p("",!0),s("div",os,[s("div",{class:"back_cell",style:f({width:a.ClicksPerc+"%"})},null,4),s("div",as,u(a.ClicksStr),1)])]))),256)):p("",!0)],64)}const ls=v(Et,[["render",rs],["__scopeId","data-v-b34e97bc"]]),is={name:"SubGroupsTable",props:["groupId"],components:{"sub-groups-item":ls},computed:{group(){return this.vueStore.groupsMap.get(`${this.groupId}`)},subGroups(){return Array.from(this.vueStore.groupsMap).filter(t=>t[1].parentGroupId==this.groupId).sort((t,d)=>t[1].groupOrder-d[1].groupOrder)}},setup(){return{vueStore:window._vueStore}},methods:{}},z=e=>(C("data-v-33eeb0ff"),e=e(),w(),e),ds={class:"hubs_groups"},cs={class:"table_header"},ns={class:"table_header_item"},us=z(()=>s("div",{class:"table_header_item"},null,-1)),_s=z(()=>s("div",{class:"table_header_item"},null,-1));function ps(e,t,d,r,c,o){const n=h("sub-groups-item");return l(),i("div",ds,[s("div",cs,[s("div",ns,u(o.group.groupName),1),us,_s]),(l(!0),i(g,null,m(o.subGroups,([a,_])=>(l(),k(n,{groupId:_.groupId},null,8,["groupId"]))),256))])}const hs=v(is,[["render",ps],["__scopeId","data-v-33eeb0ff"]]),gs={name:"HubSubTable",components:{"sub-groups-table":hs},computed:{hubGroups(){return Array.from(this.vueStore.groupsMap).filter(t=>t[1].parentGroupId=="-1").sort((t,d)=>t[1].groupOrder-d[1].groupOrder)}},setup(){return{vueStore:window._vueStore}}},vs={key:0,class:"table"};function bs(e,t,d,r,c,o){const n=h("sub-groups-table");return r.vueStore.loading==!1?(l(),i("div",vs,[(l(!0),i(g,null,m(o.hubGroups,([a,_])=>(l(),k(n,{groupId:_.groupId},null,8,["groupId"]))),256))])):p("",!0)}const ms=v(gs,[["render",bs],["__scopeId","data-v-41da097f"]]),fs={name:"TableListCTR",components:{"hub-table":At,"hub-sub-table":ms},computed:{allClicks(){return String(this.vueStore.allClicksValue).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")},allCoasts(){return String(this.vueStore.allCostValue.toFixed(0)).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" ₽"},allImpressions(){return String(this.vueStore.allImpressionsValue).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")}},setup(){const e=window._vueStore,t=S(!1);return{vueStore:e,allExpander:t}},methods:{onAllExpanderClick(){this.allExpander=!this.allExpander}}},Cs={class:"table_list_body"};function ws(e,t,d,r,c,o){const n=h("hub-table"),a=h("hub-sub-table");return l(),i("div",Cs,[b(n),b(a)])}const $s=v(fs,[["render",ws],["__scopeId","data-v-ccd1817e"]]),Ss={name:"GroupItemTitle",props:["itemData"],setup(){return{vueStore:window._vueStore}},methods:{editGroupNameOnClick(e){const t=this.vueStore.groupsMap.get(`${e}`),d=prompt("Новое имя группы",t.groupName);fetch("/group-rename",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({groupId:e,groupName:d})}).then(r=>r.json()).then(r=>{r.server_answer!="error"&&(t.groupName=d),console.debug(r)}).catch(r=>console.log("request failed",r))},addToGroupOnClick(e){console.debug(this.vueStore.groupsModalWindow),this.vueStore.groupsModalWindow.showGroupModal(`${e}`)},removeFromGroupOnClick(e){confirm("Удалить из группы")&&fetch("/group-remove-from-group",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({groupId:e})}).then(t=>t.json()).then(t=>{if(t.server_answer!="error"){const d=this.vueStore.groupsMap.get(`${e}`);d.parentGroupId="-1"}console.debug(t)}).catch(t=>console.log("request failed",t))},removeGroupOnClick(e){confirm("Удалить группу?")&&fetch("/group-remove",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({groupId:e})}).then(t=>t.json()).then(t=>{if(t.server_answer!="error"){const d=Array.from(this.vueStore.campaignsMap).filter(c=>c[1].parentId==e);for(const c of d)c[1].parentId="-1";const r=Array.from(this.vueStore.groupsMap).filter(c=>c[1].parentGroupId==e);for(const c of r)c[1].parentGroupId="-1";this.vueStore.groupsMap.delete(`${e}`)}console.debug(t)}).catch(t=>console.log("request failed",t))}}},E=e=>(C("data-v-b8b65d0e"),e=e(),w(),e),Is={class:"group_title"},ys=["title"],ks=E(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-pencil",viewBox:"0 0 16 16"},[s("path",{d:"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"})],-1)),Gs=[ks],xs=E(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-database-add",viewBox:"0 0 16 16"},[s("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm.5-5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 1 0Z"}),s("path",{d:"M12.096 6.223A4.92 4.92 0 0 0 13 5.698V7c0 .289-.213.654-.753 1.007a4.493 4.493 0 0 1 1.753.25V4c0-1.007-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1s-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4v9c0 1.007.875 1.755 1.904 2.223C4.978 15.71 6.427 16 8 16c.536 0 1.058-.034 1.555-.097a4.525 4.525 0 0 1-.813-.927C8.5 14.992 8.252 15 8 15c-1.464 0-2.766-.27-3.682-.687C3.356 13.875 3 13.373 3 13v-1.302c.271.202.58.378.904.525C4.978 12.71 6.427 13 8 13h.027a4.552 4.552 0 0 1 0-1H8c-1.464 0-2.766-.27-3.682-.687C3.356 10.875 3 10.373 3 10V8.698c.271.202.58.378.904.525C4.978 9.71 6.427 10 8 10c.262 0 .52-.008.774-.024a4.525 4.525 0 0 1 1.102-1.132C9.298 8.944 8.666 9 8 9c-1.464 0-2.766-.27-3.682-.687C3.356 7.875 3 7.373 3 7V5.698c.271.202.58.378.904.525C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777ZM3 4c0-.374.356-.875 1.318-1.313C5.234 2.271 6.536 2 8 2s2.766.27 3.682.687C12.644 3.125 13 3.627 13 4c0 .374-.356.875-1.318 1.313C10.766 5.729 9.464 6 8 6s-2.766-.27-3.682-.687C3.356 4.875 3 4.373 3 4Z"})],-1)),Ts=[xs],Ms=E(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-database-dash",viewBox:"0 0 16 16"},[s("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7ZM11 12h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1Z"}),s("path",{d:"M12.096 6.223A4.92 4.92 0 0 0 13 5.698V7c0 .289-.213.654-.753 1.007a4.493 4.493 0 0 1 1.753.25V4c0-1.007-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1s-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4v9c0 1.007.875 1.755 1.904 2.223C4.978 15.71 6.427 16 8 16c.536 0 1.058-.034 1.555-.097a4.525 4.525 0 0 1-.813-.927C8.5 14.992 8.252 15 8 15c-1.464 0-2.766-.27-3.682-.687C3.356 13.875 3 13.373 3 13v-1.302c.271.202.58.378.904.525C4.978 12.71 6.427 13 8 13h.027a4.552 4.552 0 0 1 0-1H8c-1.464 0-2.766-.27-3.682-.687C3.356 10.875 3 10.373 3 10V8.698c.271.202.58.378.904.525C4.978 9.71 6.427 10 8 10c.262 0 .52-.008.774-.024a4.525 4.525 0 0 1 1.102-1.132C9.298 8.944 8.666 9 8 9c-1.464 0-2.766-.27-3.682-.687C3.356 7.875 3 7.373 3 7V5.698c.271.202.58.378.904.525C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777ZM3 4c0-.374.356-.875 1.318-1.313C5.234 2.271 6.536 2 8 2s2.766.27 3.682.687C12.644 3.125 13 3.627 13 4c0 .374-.356.875-1.318 1.313C10.766 5.729 9.464 6 8 6s-2.766-.27-3.682-.687C3.356 4.875 3 4.373 3 4Z"})],-1)),As=[Ms],Es=E(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-trash3",viewBox:"0 0 16 16"},[s("path",{d:"M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"})],-1)),Ds=[Es];function Os(e,t,d,r,c,o){return l(),i("div",Is,[s("div",{class:"label",title:d.itemData.groupName},u(d.itemData.groupName),9,ys),s("div",{class:"edit_group_name",title:"Изменить имя группы",onClick:t[0]||(t[0]=n=>o.editGroupNameOnClick(d.itemData.groupId))},Gs),d.itemData.parentGroupId=="-1"?(l(),i("div",{key:0,class:"add_group_button",title:"Добавить в группу",onClick:t[1]||(t[1]=n=>o.addToGroupOnClick(d.itemData.groupId))},Ts)):(l(),i("div",{key:1,class:"remove_from_group_button",title:"Удалить из группы",onClick:t[2]||(t[2]=n=>o.removeFromGroupOnClick(d.itemData.groupId))},As)),s("div",{class:"delete_group_name",title:"Удалить группу",onClick:t[3]||(t[3]=n=>o.removeGroupOnClick(d.itemData.groupId))},Ds)])}const Ns=v(Ss,[["render",Os],["__scopeId","data-v-b8b65d0e"]]),Vs={name:"GroupItem",components:{"group-item-title":Ns},props:["itemData"],computed:{campaignsMapArray(){return Array.from(this.vueStore.campaignsMap).filter(e=>e[1].parentId==this.itemData.groupId)},groupsMapArray(){return Array.from(this.vueStore.groupsMap).filter(e=>e[1].parentGroupId==this.itemData.groupId).sort((e,t)=>e[1].groupOrder-t[1].groupOrder)}},setup(){const e=window._vueStore,t=S(!0),d=S(!0),r=S(!1),c=S(!1),o=S(!1);return{vueStore:e,itemsChildrenExpander:t,groupsChildrenExpander:d,borderedUp:r,borderedDown:c,dragged:o}},methods:{itemsChildrenExpanderOnClick(e){this.itemData.campaignsExtednded=!this.itemData.campaignsExtednded,console.debug(this.itemData.campaignsExtednded)},groupsChildrenExpanderOnClick(e){this.itemData.groupsExtended=!this.itemData.groupsExtended,console.debug(this.itemData.groupsExtended)},removeFromGroupOnClick(e){confirm("Удалить из группы?")&&fetch("/campaign-remove-from-group",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({campaignId:e})}).then(t=>t.json()).then(t=>{if(t.server_answer!="error"){const d=this.vueStore.campaignsMap.get(`${e}`);d.parentId="-1"}console.debug(t)}).catch(t=>console.log("request failed",t))},onGroupDragStart(e,t){this.vueStore.draggedElement=t,e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",this.dragged=!0},onGroupDragEnd(e,t){if(this.borderedUp=!1,this.borderedDown=!1,this.dragged=!1,this.vueStore.overedElement==null||this.vueStore.draggedElement==null)return;console.debug("drag end",this.vueStore.draggedElement.itemData,this.vueStore.overedElement.itemData,this.vueStore.dragElementHalf),this.vueStore.draggedElement.itemData.groupOrder=this.vueStore.dragElementHalf?this.vueStore.overedElement.itemData.groupOrder-.5:this.vueStore.overedElement.itemData.groupOrder+.5;const d=this.vueStore.overedElement.itemData.parentGroupId,r=Array.from(this.vueStore.groupsMap).filter(n=>n[1].parentGroupId==d).sort((n,a)=>n[1].groupOrder-a[1].groupOrder);let c=0;const o={};for(const[n,a]of r)o[`${a.groupId}`]=c,a.groupOrder=c++;console.debug(o),fetch("/group-set-order",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({ordersList:o})}).then(n=>n.json()).then(n=>console.debug(n)).catch(n=>console.log("request failed",n)),this.vueStore.dragElementHalf=null,this.vueStore.overedElement=null,this.vueStore.draggedElement==null},onGroupDragOver(e,t){if(t==this.vueStore.draggedElement||t.itemData.groupLevel!=this.vueStore.draggedElement.itemData.groupLevel||t.itemData.parentGroupId!=this.vueStore.draggedElement.itemData.parentGroupId)return;function d(c){let o=c.getBoundingClientRect(),n=document.body,a=document.documentElement,_=window.pageYOffset||a.scrollTop||n.scrollTop,x=window.pageXOffset||a.scrollLeft||n.scrollLeft,D=a.clientTop||n.clientTop||0,O=a.clientLeft||n.clientLeft||0,I=o.top+_-D,q=o.left+x-O;return{top:I,left:q}}const r=e.clientY-d(this.$refs.item).top<=this.$refs.item.getBoundingClientRect().height*.5;this.borderedUp=!!r,this.borderedDown=!r,e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",this.vueStore.overedElement=t,this.vueStore.dragElementHalf=r},onGroupDragLeave(){this.borderedUp=!1,this.borderedDown=!1}}},A=e=>(C("data-v-977e6445"),e=e(),w(),e),Ps=["group_id"],Rs={class:"group_childs"},Ls={key:0,class:"items_children"},Hs=A(()=>s("div",{class:"title"},"Кампании",-1)),js=A(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-caret-right",viewBox:"0 0 16 16"},[s("path",{d:"M6 12.796V3.204L11.481 8 6 12.796zm.659.753 5.48-4.796a1 1 0 0 0 0-1.506L6.66 2.451C6.011 1.885 5 2.345 5 3.204v9.592a1 1 0 0 0 1.659.753z"})],-1)),zs=[js],Fs={key:0,class:"items_children_list"},Bs={class:"campaign_name"},Zs={class:"campaign_label"},qs={class:"campaign_icons"},Ws=["onClick"],Js=A(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-database-dash",viewBox:"0 0 16 16"},[s("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7ZM11 12h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1Z"}),s("path",{d:"M12.096 6.223A4.92 4.92 0 0 0 13 5.698V7c0 .289-.213.654-.753 1.007a4.493 4.493 0 0 1 1.753.25V4c0-1.007-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1s-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4v9c0 1.007.875 1.755 1.904 2.223C4.978 15.71 6.427 16 8 16c.536 0 1.058-.034 1.555-.097a4.525 4.525 0 0 1-.813-.927C8.5 14.992 8.252 15 8 15c-1.464 0-2.766-.27-3.682-.687C3.356 13.875 3 13.373 3 13v-1.302c.271.202.58.378.904.525C4.978 12.71 6.427 13 8 13h.027a4.552 4.552 0 0 1 0-1H8c-1.464 0-2.766-.27-3.682-.687C3.356 10.875 3 10.373 3 10V8.698c.271.202.58.378.904.525C4.978 9.71 6.427 10 8 10c.262 0 .52-.008.774-.024a4.525 4.525 0 0 1 1.102-1.132C9.298 8.944 8.666 9 8 9c-1.464 0-2.766-.27-3.682-.687C3.356 7.875 3 7.373 3 7V5.698c.271.202.58.378.904.525C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777ZM3 4c0-.374.356-.875 1.318-1.313C5.234 2.271 6.536 2 8 2s2.766.27 3.682.687C12.644 3.125 13 3.627 13 4c0 .374-.356.875-1.318 1.313C10.766 5.729 9.464 6 8 6s-2.766-.27-3.682-.687C3.356 4.875 3 4.373 3 4Z"})],-1)),Us=[Js],Ys={key:1,class:"groups_children"},Xs=A(()=>s("div",{class:"title"},"Подгруппы",-1)),Ks=A(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-caret-right",viewBox:"0 0 16 16"},[s("path",{d:"M6 12.796V3.204L11.481 8 6 12.796zm.659.753 5.48-4.796a1 1 0 0 0 0-1.506L6.66 2.451C6.011 1.885 5 2.345 5 3.204v9.592a1 1 0 0 0 1.659.753z"})],-1)),Qs=[Ks],eo={key:0,class:"groups_children_list"};function to(e,t,d,r,c,o){const n=h("group-item-title"),a=h("GroupItem",!0);return l(),i("div",{class:$(["group_item",[r.borderedUp?"borderedUp":!1,r.borderedDown?"borderedDown":!1,r.dragged?"dragged":!1]]),group_id:d.itemData.groupId,draggable:"true",ref:"item",onDragstart:t[2]||(t[2]=N(_=>o.onGroupDragStart(_,this),["stop"])),onDragover:t[3]||(t[3]=N(_=>o.onGroupDragOver(_,this),["stop"])),onDragend:t[4]||(t[4]=N(_=>o.onGroupDragEnd(_,this),["stop"])),onDragleave:t[5]||(t[5]=_=>o.onGroupDragLeave())},[b(n,{itemData:d.itemData},null,8,["itemData"]),s("div",Rs,[o.campaignsMapArray.length>0?(l(),i("div",Ls,[Hs,s("div",{class:$(["expander",{expanded:d.itemData.campaignsExtednded}]),onClick:t[0]||(t[0]=(..._)=>o.itemsChildrenExpanderOnClick&&o.itemsChildrenExpanderOnClick(..._))},zs,2)])):p("",!0),b(L,{name:"scaler"},{default:y(()=>[d.itemData.campaignsExtednded==!0&&o.campaignsMapArray.length>0?(l(),i("div",Fs,[(l(!0),i(g,null,m(o.campaignsMapArray,_=>(l(),i("div",Bs,[s("div",Zs,u(_[1].CampaignName),1),s("div",qs,[s("div",{class:"remove_from_group",title:"Удалить из группы",onClick:x=>o.removeFromGroupOnClick(_[1].CampaignId)},Us,8,Ws)])]))),256))])):p("",!0)]),_:1}),o.groupsMapArray.length>0?(l(),i("div",Ys,[Xs,s("div",{class:$(["expander",{expanded:d.itemData.groupsExtended}]),onClick:t[1]||(t[1]=(..._)=>o.groupsChildrenExpanderOnClick&&o.groupsChildrenExpanderOnClick(..._))},Qs,2)])):p("",!0),b(L,{name:"scaler"},{default:y(()=>[d.itemData.groupsExtended==!0&&o.groupsMapArray.length>0?(l(),i("div",eo,[(l(!0),i(g,null,m(o.groupsMapArray,_=>(l(),k(a,{itemData:_[1]},null,8,["itemData"]))),256))])):p("",!0)]),_:1})])],42,Ps)}const so=v(Vs,[["render",to],["__scopeId","data-v-977e6445"]]),oo={name:"ModalWindow",data:function(){return{show:!1}},setup(){return{vueStore:window._vueStore}},methods:{showModal:function(){this.show=!0},closeModal:function(){this.show=!1}}},ao=e=>(C("data-v-b2109bb8"),e=e(),w(),e),ro={key:0,class:"modal-shadow"},lo={class:"modal"},io={class:"modal_header"},co=ao(()=>s("h3",{class:"modal-title"},"Заголовок",-1)),no={class:"modal_content"},uo={class:"modal_footer"};function _o(e,t,d,r,c,o){return e.show?(l(),i("div",ro,[s("div",lo,[s("div",io,[V(e.$slots,"title",{},()=>[co],!0),s("div",{class:"modal-close",onClick:t[0]||(t[0]=(...n)=>o.closeModal&&o.closeModal(...n))},"✖")]),s("div",no,[V(e.$slots,"body",{},()=>[P(" body ")],!0)]),s("div",uo,[V(e.$slots,"footer",{},()=>[s("button",{class:"modal-footer__button",onClick:t[1]||(t[1]=(...n)=>o.closeModal&&o.closeModal(...n))}," Ок ")],!0)])])])):p("",!0)}const F=v(oo,[["render",_o],["__scopeId","data-v-b2109bb8"]]),po={name:"GroupsList",components:{"group-item":so,"modal-window":F},computed:{groupsMapArray(){const e=Array.from(this.vueStore.groupsMap).filter(t=>t[1].parentGroupId=="-1").sort((t,d)=>t[1].groupOrder-d[1].groupOrder);return console.debug(e),e},filteredHierarchyGroupArray(){const e=[],t=this.vueStore.groupsMap,d=t.get(`${this.subGroupId}`);function r(c){e.push(c.groupId);const o=Array.from(t).filter(n=>n[1].parentGroupId==c.groupId);for(const n of o){const a=t.get(`${n[1].groupId}`);r(a)}}return r(d),Array.from(this.vueStore.groupsMap).filter(c=>!e.includes(c[1].groupId))}},setup(){const e=window._vueStore,t=-1,d=S(-1);return{vueStore:e,currentGroupId:t,subGroupId:d}},mounted(){this.vueStore.groupsModalWindow=this},methods:{toggleGroup(e){const t=this.vueStore.groupsMap.get(`${e}`);if(t)if(t.chosen)t.chosen=!1,this.currentGroupId=-1;else{for(const d of Array.from(this.vueStore.groupsMap))d[1].chosen=!1;t.chosen=!0,this.currentGroupId=t.groupId}},buttonAddClick(){console.debug(this.currentGroupId,this.subGroupId),this.$refs.modalWindow.show=!1,this.currentGroupId!=-1&&this.subGroupId!=-1&&fetch("/group-add-to-group",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({groupId:this.subGroupId,parentGroupId:this.currentGroupId})}).then(e=>e.json()).then(e=>{if(e.server_answer!="error"){const t=this.vueStore.groupsMap.get(`${this.subGroupId}`);t.parentGroupId=this.currentGroupId}console.debug(e)}).catch(e=>console.log("request failed",e))},showGroupModal(e){for(const t of Array.from(this.vueStore.groupsMap))t[1].chosen=!1;this.$refs.modalWindow.show=!0,this.subGroupId=e,console.debug(e)},addNewGroup(){const e=prompt("Введите имя новой группы","");fetch("/group-add",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({groupName:e})}).then(t=>t.json()).then(t=>{t.server_answer!="error"&&this.vueStore.groupsMap.set(`${t.group_id}`,{groupId:`${t.group_id}`,groupName:`${t.groupName}`,parentGroupId:"-1",chosen:!1,campaignsExtednded:!0,groupsExtended:!0}),console.debug(t)}).catch(t=>console.log("request failed",t))}}},R=e=>(C("data-v-27c9b9a8"),e=e(),w(),e),ho=R(()=>s("h3",{class:"modal-title"},"Добавить группу в другую группу",-1)),go=["onClick"],vo={class:"group_label"},bo={key:0,class:"group_marker"},mo=R(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-check-lg",viewBox:"0 0 16 16"},[s("path",{d:"M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425a.247.247 0 0 1 .02-.022Z"})],-1)),fo=[mo],Co={class:"list_header"},wo=R(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-plus-circle",viewBox:"0 0 16 16"},[s("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"}),s("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)),$o=[wo],So={class:"list_body"};function Io(e,t,d,r,c,o){const n=h("modal-window"),a=h("group-item");return l(),i(g,null,[b(n,{ref:"modalWindow"},{title:y(()=>[ho]),body:y(()=>[(l(!0),i(g,null,m(o.filteredHierarchyGroupArray,_=>(l(),i("div",{class:"group_name",onClick:x=>o.toggleGroup(_[1].groupId)},[s("div",vo,u(_[1].groupName),1),_[1].chosen?(l(),i("div",bo,fo)):p("",!0)],8,go))),256))]),footer:y(()=>[s("button",{onClick:t[0]||(t[0]=(..._)=>o.buttonAddClick&&o.buttonAddClick(..._))},"Добавить")]),_:1},512),s("div",Co,[s("div",{class:"add_new_group",title:"Создать новую группу",onClick:t[1]||(t[1]=(..._)=>o.addNewGroup&&o.addNewGroup(..._))},$o)]),s("div",So,[(l(!0),i(g,null,m(o.groupsMapArray,_=>(l(),k(a,{itemData:_[1]},null,8,["itemData"]))),256))])],64)}const yo=v(po,[["render",Io],["__scopeId","data-v-27c9b9a8"]]),ko={name:"ModalGroupDialog",components:{"modal-window":F},setup(){return{vueStore:window._vueStore,currentGroupId:-1,currentCampaignId:-1}},methods:{showModal:function(e=-1){this.currentCampaignId=e,this.$refs.modalWindow.showModal(),this.currentGroupId=-1;for(const t of Array.from(this.vueStore.groupsMap))t[1].chosen=!1},closeModal:function(){this.$refs.modalWindow.closeModal()},toggleGroup(e){const t=this.vueStore.groupsMap.get(`${e}`);if(t)if(t.chosen)t.chosen=!1,this.currentGroupId=-1;else{for(const d of Array.from(this.vueStore.groupsMap))d[1].chosen=!1;t.chosen=!0,this.currentGroupId=t.groupId}},buttonAddClick(){console.debug(this.currentGroupId,this.currentCampaignId),this.closeModal(),this.currentGroupId!=-1&&this.currentCampaignId!=-1&&fetch("/campaign-add-to-group",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({groupId:this.currentGroupId,campaignId:this.currentCampaignId})}).then(e=>e.json()).then(e=>{if(e.server_answer!="error"){const t=this.vueStore.campaignsMap.get(`${this.currentCampaignId}`);t.parentId=this.currentGroupId}console.debug(e)}).catch(e=>console.log("request failed",e))}}},B=e=>(C("data-v-1347f4c7"),e=e(),w(),e),Go=B(()=>s("h3",{class:"modal-title"},"Добавить кампанию в группу",-1)),xo=["onClick"],To={class:"group_label"},Mo={key:0,class:"group_marker"},Ao=B(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-check-lg",viewBox:"0 0 16 16"},[s("path",{d:"M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425a.247.247 0 0 1 .02-.022Z"})],-1)),Eo=[Ao];function Do(e,t,d,r,c,o){const n=h("modal-window");return l(),k(n,{ref:"modalWindow"},{title:y(()=>[Go]),body:y(()=>[(l(!0),i(g,null,m(Array.from(r.vueStore.groupsMap),a=>(l(),i("div",{class:"group_name",onClick:_=>o.toggleGroup(a[1].groupId)},[s("div",To,u(a[1].groupName),1),a[1].chosen?(l(),i("div",Mo,Eo)):p("",!0)],8,xo))),256))]),footer:y(()=>[s("button",{onClick:t[0]||(t[0]=(...a)=>o.buttonAddClick&&o.buttonAddClick(...a))},"Добавить")]),_:1},512)}const Oo=v(ko,[["render",Do],["__scopeId","data-v-1347f4c7"]]),No={name:"CampaignList",components:{"modal-group-dialog":Oo},setup(){return{vueStore:window._vueStore}},methods:{showModalAddToGroup(e){this.$refs.modalGroupDialog.showModal(e)}}},Vo=e=>(C("data-v-fda119b4"),e=e(),w(),e),Po={class:"compaign_item"},Ro=["title"],Lo=["onClick"],Ho=Vo(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-database-add",viewBox:"0 0 16 16"},[s("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm.5-5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 1 0Z"}),s("path",{d:"M12.096 6.223A4.92 4.92 0 0 0 13 5.698V7c0 .289-.213.654-.753 1.007a4.493 4.493 0 0 1 1.753.25V4c0-1.007-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1s-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4v9c0 1.007.875 1.755 1.904 2.223C4.978 15.71 6.427 16 8 16c.536 0 1.058-.034 1.555-.097a4.525 4.525 0 0 1-.813-.927C8.5 14.992 8.252 15 8 15c-1.464 0-2.766-.27-3.682-.687C3.356 13.875 3 13.373 3 13v-1.302c.271.202.58.378.904.525C4.978 12.71 6.427 13 8 13h.027a4.552 4.552 0 0 1 0-1H8c-1.464 0-2.766-.27-3.682-.687C3.356 10.875 3 10.373 3 10V8.698c.271.202.58.378.904.525C4.978 9.71 6.427 10 8 10c.262 0 .52-.008.774-.024a4.525 4.525 0 0 1 1.102-1.132C9.298 8.944 8.666 9 8 9c-1.464 0-2.766-.27-3.682-.687C3.356 7.875 3 7.373 3 7V5.698c.271.202.58.378.904.525C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777ZM3 4c0-.374.356-.875 1.318-1.313C5.234 2.271 6.536 2 8 2s2.766.27 3.682.687C12.644 3.125 13 3.627 13 4c0 .374-.356.875-1.318 1.313C10.766 5.729 9.464 6 8 6s-2.766-.27-3.682-.687C3.356 4.875 3 4.373 3 4Z"})],-1)),jo=[Ho];function zo(e,t,d,r,c,o){const n=h("modal-group-dialog");return l(),i(g,null,[b(n,{ref:"modalGroupDialog"},null,512),(l(!0),i(g,null,m(Array.from(r.vueStore.campaignsMap).filter(a=>a[1].parentId==-1),a=>(l(),i("div",null,[s("div",Po,[s("div",{class:"label",title:a[1].CampaignName},u(a[1].CampaignName),9,Ro),s("div",{class:"add_group_button",title:"Добавить в группу",onClick:_=>o.showModalAddToGroup(a[1].CampaignId)},jo,8,Lo)])]))),256))],64)}const Fo=v(No,[["render",zo],["__scopeId","data-v-fda119b4"]]),Bo={name:"CostTable",computed:{statistics(){const e={campaignsTypesList:{},campaignsTypesResult:{Count:0,Cost:0,Clicks:0,Impressions:0,CPC:0,CTR:0}},t=[];for(const[r,c]of this.vueStore.campaignsMap)t.push(c.CampaignType);const d=new Set(t);for(const r of d){const c={Type:r,Count:0,Cost:0,Clicks:0,Impressions:0,CPC:0,CTR:0},o=Array.from(this.vueStore.campaignsMap).filter(n=>n[1].CampaignType==r);for(const[n,a]of o)c.Count++,c.Cost+=a.Cost,c.Clicks+=a.Clicks,c.Impressions+=a.Impressions;c.CPC=c.Clicks?c.Cost/c.Clicks:0,c.CTR=c.Impressions!=0?100*c.Clicks/c.Impressions:0,e.campaignsTypesList[`${r}`]=c,e.campaignsTypesResult.Count+=c.Count,e.campaignsTypesResult.Cost+=c.Cost,e.campaignsTypesResult.Clicks+=c.Clicks,e.campaignsTypesResult.Impressions+=c.Impressions}e.campaignsTypesResult.CPC+=e.campaignsTypesResult.Clicks?e.campaignsTypesResult.Cost/e.campaignsTypesResult.Clicks:0,e.campaignsTypesResult.CTR+=e.campaignsTypesResult.Impressions!=0?100*e.campaignsTypesResult.Clicks/e.campaignsTypesResult.Impressions:0;for(const r of d){const c=e.campaignsTypesList[`${r}`];c.CostPerc=Number(100*c.Cost/e.campaignsTypesResult.Cost),c.ImpressionsPerc=Number(100*c.Impressions/e.campaignsTypesResult.Impressions),c.ClicksPerc=Number(100*c.Clicks/e.campaignsTypesResult.Clicks)}return e},lastDayValue(){const e=Array.from(this.vueStore.costsMap.values()).pop(),t=Object.values(e).slice(-2,-1)[0];return String(t).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" ₽"}},setup(){return{vueStore:window._vueStore}},methods:{getMonth(e){const t={"01":"Январь","02":"Февраль","03":"Март","04":"Апрель","05":"Май","06":"Июнь","07":"Июль","08":"Август","09":"Сентябрь",10:"Октябрь",11:"Ноябрь",12:"Декабрь"};return`${e}`in t?t[`${e}`]:""},getCampaignType(e){const t={TEXT_CAMPAIGN:"Текстово-графические объявления",UNIFIED_CAMPAIGN:"Единая перфоманс кампания",SMART_CAMPAIGN:"Смарт-баннеры",DYNAMIC_TEXT_CAMPAIGN:"Динамические объявления",MOBILE_APP_CAMPAIGN:"Реклама мобильных приложений",MCBANNER_CAMPAIGN:"Баннер на поиске",CPM_BANNER_CAMPAIGN:"Медийная кампания",CPM_DEALS_CAMPAIGN:"Медийная кампания со сделками",CPM_FRONTPAGE_CAMPAIGN:"Медийная кампания на Главной",CPM_PRICE:"Кампания с фиксированным СРМ"};return`${e}`in t?t[`${e}`]:""}}},Z=e=>(C("data-v-99dfb491"),e=e(),w(),e),Zo={key:0,class:"table"},qo={class:"table_row"},Wo={class:"table_row_item"},Jo={class:"table_row_item"},Uo={class:"front_cell"},Yo={class:"table_row_item"},Xo={class:"front_cell"},Ko={class:"table_row_item"},Qo={class:"front_cell"},ea={class:"table_row_item"},ta={class:"table_row_item"},sa={class:"table_row_item"},oa={class:"table_footer"},aa=Z(()=>s("div",{class:"table_footer_item"},"Итого",-1)),ra={class:"table_footer_item"},la={class:"table_footer_item"},ia={class:"table_footer_item"},da={class:"table_footer_item"},ca={class:"table_footer_item"},na={class:"table_footer_item"},ua=Z(()=>s("div",{class:"charts_title"},"Общая динамика трат по месяцам:",-1)),_a={class:"charts_table_wrapper"},pa={class:"charts_table"},ha={class:"last_day_coast"};function ga(e,t,d,r,c,o){const n=h("line-chart");return r.vueStore.loading==!1?(l(),i("div",Zo,[(l(!0),i(g,null,m(o.statistics.campaignsTypesList,a=>(l(),i("div",qo,[s("div",Wo,u(o.getCampaignType(a.Type)),1),s("div",Jo,[s("div",{class:"back_cell",style:f({width:a.CostPerc+"%"})},null,4),s("div",Uo,u(String(a.Cost.toFixed(0)).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" ₽"),1)]),s("div",Yo,[s("div",{class:"back_cell",style:f({width:a.ImpressionsPerc+"%"})},null,4),s("div",Xo,u(String(a.Impressions).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")),1)]),s("div",Ko,[s("div",{class:"back_cell",style:f({width:a.ClicksPerc+"%"})},null,4),s("div",Qo,u(String(a.Clicks).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")),1)]),s("div",ea,u(String(a.Count).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")),1),s("div",ta,u(String(a.CPC.toFixed(1)).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" ₽"),1),s("div",sa,u(String(a.CTR.toFixed(3)).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" %"),1)]))),256)),s("div",oa,[aa,s("div",ra,u(String(o.statistics.campaignsTypesResult.Cost.toFixed(0)).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" ₽"),1),s("div",la,u(String(o.statistics.campaignsTypesResult.Impressions).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")),1),s("div",ia,u(String(o.statistics.campaignsTypesResult.Clicks).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")),1),s("div",da,u(String(o.statistics.campaignsTypesResult.Count).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")),1),s("div",ca,u(String(o.statistics.campaignsTypesResult.CPC.toFixed(1)).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" ₽"),1),s("div",na,u(String(o.statistics.campaignsTypesResult.CTR.toFixed(3)).replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")+" %"),1)]),ua,s("div",_a,[(l(!0),i(g,null,m(r.vueStore.costsMap,([a,_])=>(l(),i("div",pa,[b(n,{title:o.getMonth(a),data:_,suffix:" ₽",thousands:" "},null,8,["title","data"])]))),256))]),s("div",ha,"Траты за вчерашний день = "+u(o.lastDayValue),1)])):p("",!0)}const va=v(Bo,[["render",ga],["__scopeId","data-v-99dfb491"]]),ba={name:"RootVue",components:{"table-list-all":se,"table-list-cpc":_t,"table-list-ctr":$s,"groups-list":yo,"campaign-list":Fo,"cost-table":va},setup(){const e=S(0),t=window._vueStore;return{activeTab:e,vueStore:t}},methods:{setActiveTab(e){this.activeTab=e},onPeriodChange(e){console.log(e.target.value),window._vueStore.setup(e.target.value)}}},G=e=>(C("data-v-409bba9c"),e=e(),w(),e),ma={class:"work_area"},fa={class:"tabs_area"},Ca={class:"tabs_area_header_wrapper"},wa={class:"tabs_area_header"},$a={class:"table_list_header"},Sa=G(()=>s("option",{value:"YESTERDAY"},"Вчера",-1)),Ia=G(()=>s("option",{value:"LAST_WEEK"},"Неделя",-1)),ya=G(()=>s("option",{value:"THIS_MONTH"},"Месяц",-1)),ka=[Sa,Ia,ya],Ga={key:0,class:"table_header_wrapper"},xa=H('<div class="table_header" data-v-409bba9c><div class="table_header_item" data-v-409bba9c>Категория</div><div class="table_header_item" data-v-409bba9c>Расход с НДС</div><div class="table_header_item" data-v-409bba9c>Показов</div><div class="table_header_item" data-v-409bba9c>Кликов</div></div>',1),Ta=[xa],Ma={key:1,class:"table_header_wrapper"},Aa=G(()=>s("div",{class:"table_header"},[s("div",{class:"table_header_item",style:{width:"280px"}},"Категория"),s("div",{class:"table_header_item"},"Расход с НДС"),s("div",{class:"table_header_item"},"Кликов")],-1)),Ea=[Aa],Da={key:2,class:"table_header_wrapper"},Oa=G(()=>s("div",{class:"table_header"},[s("div",{class:"table_header_item",style:{width:"280px"}},"Категория"),s("div",{class:"table_header_item"},"Показов"),s("div",{class:"table_header_item"},"Кликов")],-1)),Na=[Oa],Va={key:3,class:"table_header_wrapper",style:{position:"relative",top:"0px","z-index":"0"}},Pa=H('<div class="table_header" data-v-409bba9c><div class="table_header_item" style="width:200px;padding-left:5px;padding-right:5px;" data-v-409bba9c>Тип кампании</div><div class="table_header_item" style="width:100px;padding-left:5px;padding-right:5px;" data-v-409bba9c>Траты</div><div class="table_header_item" style="width:100px;padding-left:5px;padding-right:5px;" data-v-409bba9c>Показов</div><div class="table_header_item" style="width:100px;padding-left:5px;padding-right:5px;" data-v-409bba9c>Кликов</div><div class="table_header_item" style="width:100px;padding-left:5px;padding-right:5px;margin-left:10px;" data-v-409bba9c>Кол-во</div><div class="table_header_item" style="width:100px;padding-left:5px;padding-right:5px;" data-v-409bba9c>CPC</div><div class="table_header_item" style="width:100px;padding-left:5px;padding-right:5px;" data-v-409bba9c>CTR</div></div>',1),Ra=[Pa],La={key:4,class:"pre_loader"},Ha=G(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",fill:"currentColor",class:"bi bi-gear",viewBox:"0 0 16 16"},[s("path",{d:"M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"}),s("path",{d:"M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"})],-1)),ja=G(()=>s("div",null,"Загрузка ...",-1)),za=[Ha,ja],Fa={class:"tabs_area_body_wrapper"},Ba={class:"tabs_area_body"},Za={class:"tab_panel_left"},qa={class:"tab_panel_right"};function Wa(e,t,d,r,c,o){const n=h("table-list-all"),a=h("table-list-cpc"),_=h("table-list-ctr"),x=h("cost-table"),D=h("groups-list"),O=h("campaign-list");return l(),i("div",ma,[s("div",fa,[s("div",Ca,[s("div",wa,[s("div",$a,[s("select",{name:"period",id:"peiod_select",onChange:t[0]||(t[0]=I=>o.onPeriodChange(I))},ka,32)]),s("div",{class:$(["tab_button",r.activeTab==0?"active":!1]),onClick:t[1]||(t[1]=I=>o.setActiveTab(0))},"Все",2),s("div",{class:$(["tab_button",r.activeTab==1?"active":!1]),onClick:t[2]||(t[2]=I=>o.setActiveTab(1))},"CPC",2),s("div",{class:$(["tab_button",r.activeTab==2?"active":!1]),onClick:t[3]||(t[3]=I=>o.setActiveTab(2))},"CTR",2),s("div",{class:$(["tab_button",r.activeTab==3?"active":!1]),onClick:t[4]||(t[4]=I=>o.setActiveTab(3))},"Статистика",2),s("div",{class:$(["tab_button",r.activeTab==4?"active":!1]),onClick:t[5]||(t[5]=I=>o.setActiveTab(4))},"Конструктор",2)])]),r.vueStore.loading==!1&&r.activeTab==0?(l(),i("div",Ga,Ta)):p("",!0),r.vueStore.loading==!1&&r.activeTab==1?(l(),i("div",Ma,Ea)):p("",!0),r.vueStore.loading==!1&&r.activeTab==2?(l(),i("div",Da,Na)):p("",!0),r.vueStore.loading==!1&&r.activeTab==3?(l(),i("div",Va,Ra)):p("",!0),r.vueStore.loading==!0?(l(),i("div",La,za)):p("",!0),s("div",Fa,[s("div",Ba,[r.vueStore.loading==!1&&r.activeTab==0?(l(),i("div",{key:0,class:$(["tab_panel table",r.activeTab==0?"active":!1])},[b(n)],2)):p("",!0),r.vueStore.loading==!1&&r.activeTab==1?(l(),i("div",{key:1,class:$(["tab_panel table",r.activeTab==1?"active":!1])},[b(a)],2)):p("",!0),r.vueStore.loading==!1&&r.activeTab==2?(l(),i("div",{key:2,class:$(["tab_panel table",r.activeTab==2?"active":!1])},[b(_)],2)):p("",!0),r.vueStore.loading==!1&&r.activeTab==3?(l(),i("div",{key:3,class:$(["tab_panel table",r.activeTab==3?"active":!1])},[b(x)],2)):p("",!0),r.vueStore.loading==!1&&r.activeTab==4?(l(),i("div",{key:4,class:$(["tab_panel constructor",r.activeTab==4?"active":!1])},[s("div",Za,[b(D)]),s("div",qa,[b(O)])],2)):p("",!0)])])])])}const Ya=v(ba,[["render",Wa],["__scopeId","data-v-409bba9c"]]);export{Ya as default};
